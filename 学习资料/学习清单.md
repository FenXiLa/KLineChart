# KLineChart 项目学习清单

## 📚 项目概述
KLineChart 是一个基于 HTML5 Canvas 的轻量级 K 线图库，使用 TypeScript 开发，零依赖，Gzip 压缩后约 40k。

## 🎯 学习路径

### 阶段一：项目基础了解（1-2天）

#### ✅ 任务 1.1：了解项目基本信息
- [ ] 阅读 README.md，了解项目定位和特性
- [ ] 查看 package.json，了解项目依赖和构建脚本
- [ ] 访问在线文档：https://www.klinecharts.com
- [ ] 运行本地文档：`pnpm install && pnpm docs:dev`

#### ✅ 任务 1.2：环境搭建
- [ ] 安装 Node.js（推荐 v18+）
- [ ] 安装 pnpm：`npm install -g pnpm`
- [ ] 克隆或进入项目目录
- [ ] 安装依赖：`pnpm install`
- [ ] 构建项目：`pnpm build`
- [ ] 运行文档：`pnpm docs:dev`

#### ✅ 任务 1.3：项目结构分析
- [ ] 理解 `src/` 目录结构
  - `common/` - 通用工具和类型定义
  - `component/` - 核心组件（指标、画线、坐标轴等）
  - `extension/` - 扩展功能（指标、画线模型、国际化等）
  - `pane/` - 面板管理（K线面板、指标面板等）
  - `view/` - 视图渲染层
  - `widget/` - 组件层
- [ ] 查看 `src/index.ts`，了解入口导出
- [ ] 查看 `src/Chart.ts`，了解核心类结构

---

### 阶段二：核心概念理解（3-5天）

#### ✅ 任务 2.1：入口和初始化流程
- [ ] 阅读 `src/index.ts`
  - 理解 `init()` 函数如何创建图表实例
  - 理解 `dispose()` 函数如何销毁实例
  - 了解注册机制（registerFigure, registerIndicator 等）
- [ ] 阅读 `src/Chart.ts`（重点）
  - 理解 ChartImp 类的构造函数
  - 理解图表初始化的完整流程
  - 理解 Store 的作用

#### ✅ 任务 2.2：数据模型
- [ ] 阅读 `src/common/Data.ts`
  - 理解 KLineData 数据结构
  - 理解数据如何存储和管理
- [ ] 阅读 `src/Store.ts`
  - 理解状态管理机制
  - 理解数据更新流程

#### ✅ 任务 2.3：坐标系统
- [ ] 阅读 `src/common/Coordinate.ts`
  - 理解屏幕坐标和逻辑坐标的转换
- [ ] 阅读 `src/common/Point.ts`
  - 理解数据点（时间、价格）的概念
- [ ] 理解 `convertToPixel()` 和 `convertFromPixel()` 方法

#### ✅ 任务 2.4：渲染系统
- [ ] 阅读 `src/common/Canvas.ts`
  - 理解 Canvas 的创建和管理
- [ ] 阅读 `src/view/View.ts`
  - 理解视图基类
- [ ] 阅读 `src/view/CandleBarView.ts`
  - 理解 K 线如何绘制
- [ ] 阅读 `src/view/GridView.ts`
  - 理解网格如何绘制

---

### 阶段三：核心功能深入（5-7天）

#### ✅ 任务 3.1：面板系统（Pane）
- [ ] 阅读 `src/pane/Pane.ts`
  - 理解面板基类
- [ ] 阅读 `src/pane/CandlePane.ts`
  - 理解 K 线面板的实现
- [ ] 阅读 `src/pane/IndicatorPane.ts`
  - 理解指标面板的实现
- [ ] 理解面板的布局和管理机制

#### ✅ 任务 3.2：指标系统（Indicator）
- [ ] 阅读 `src/component/Indicator.ts`
  - 理解指标组件的接口定义
- [ ] 阅读 `src/extension/indicator/index.ts`
  - 理解指标的注册机制
- [ ] 选择一个简单指标深入学习（如 `movingAverage.ts`）
  - 理解指标的计算逻辑
  - 理解指标的绘制逻辑
- [ ] 阅读 `src/view/IndicatorView.ts`
  - 理解指标如何渲染

#### ✅ 任务 3.3：画线系统（Overlay）
- [ ] 阅读 `src/component/Overlay.ts`
  - 理解画线组件的接口定义
- [ ] 阅读 `src/extension/overlay/index.ts`
  - 理解画线的注册机制
- [ ] 选择一个简单画线深入学习（如 `straightLine.ts`）
  - 理解画线的创建和编辑逻辑
  - 理解画线的绘制逻辑
- [ ] 阅读 `src/view/OverlayView.ts`
  - 理解画线如何渲染

#### ✅ 任务 3.4：坐标轴系统
- [ ] 阅读 `src/component/XAxis.ts` 和 `src/component/YAxis.ts`
  - 理解 X 轴和 Y 轴的作用
- [ ] 阅读 `src/view/XAxisView.ts` 和 `src/view/YAxisView.ts`
  - 理解坐标轴的渲染
- [ ] 理解不同坐标轴类型（普通、对数、百分比）

---

### 阶段四：交互和事件（3-4天）

#### ✅ 任务 4.1：事件系统
- [ ] 阅读 `src/Event.ts`
  - 理解事件系统的设计
- [ ] 阅读 `src/common/Eventful.ts`
  - 理解事件发布订阅机制
- [ ] 理解鼠标和触摸事件的处理

#### ✅ 任务 4.2：交互功能
- [ ] 理解缩放（zoom）功能
  - 查看 `zoomAtCoordinate()` 等方法
- [ ] 理解滚动（scroll）功能
  - 查看 `scrollByDistance()` 等方法
- [ ] 理解十字光标（Crosshair）
  - 阅读 `src/common/Crosshair.ts`
  - 阅读 `src/view/CrosshairLineView.ts`
- [ ] 理解工具提示（Tooltip）
  - 阅读 `src/view/CandleTooltipView.ts`
  - 阅读 `src/view/IndicatorTooltipView.ts`

#### ✅ 任务 4.3：动作系统（Action）
- [ ] 阅读 `src/common/Action.ts`
  - 理解动作类型（缩放、平移、绘制等）
- [ ] 理解 `executeAction()` 和 `subscribeAction()` 方法

---

### 阶段五：扩展机制（3-4天）

#### ✅ 任务 5.1：自定义指标
- [ ] 阅读文档：`docs/guide/indicator.md`
- [ ] 理解如何注册自定义指标
- [ ] 尝试创建一个简单的自定义指标

#### ✅ 任务 5.2：自定义画线
- [ ] 阅读文档：`docs/guide/overlay.md`
- [ ] 理解如何注册自定义画线
- [ ] 尝试创建一个简单的自定义画线

#### ✅ 任务 5.3：样式定制
- [ ] 阅读 `src/common/Styles.ts`
  - 理解样式配置结构
- [ ] 阅读 `src/extension/styles/index.ts`
  - 理解主题系统
- [ ] 阅读文档：`docs/guide/styles.md`

#### ✅ 任务 5.4：国际化
- [ ] 阅读 `src/extension/i18n/index.ts`
  - 理解国际化机制
- [ ] 查看 `src/extension/i18n/zh-CN.ts` 和 `en-US.ts`

---

### 阶段六：高级特性（4-5天）

#### ✅ 任务 6.1：动画系统
- [ ] 阅读 `src/common/Animation.ts`
  - 理解动画的实现机制

#### ✅ 任务 6.2：性能优化
- [ ] 阅读 `src/common/TaskScheduler.ts`
  - 理解任务调度机制
- [ ] 阅读 `src/common/Updater.ts`
  - 理解更新机制和更新级别
- [ ] 理解可见区域（VisibleRange）的概念
  - 阅读 `src/common/VisibleRange.ts`

#### ✅ 任务 6.3：数据加载
- [ ] 阅读 `src/common/DataLoader.ts`
  - 理解数据加载机制
- [ ] 理解如何实现增量数据更新

---

### 阶段七：实践项目（5-7天）

#### ✅ 任务 7.1：简单示例
- [ ] 创建一个简单的 HTML 页面
- [ ] 使用 CDN 方式引入 KLineChart
- [ ] 创建一个基本的 K 线图
- [ ] 添加一些指标
- [ ] 添加一些画线工具

#### ✅ 任务 7.2：完整应用
- [ ] 使用 npm 方式集成
- [ ] 连接真实数据源（如 WebSocket）
- [ ] 实现数据实时更新
- [ ] 实现自定义主题
- [ ] 实现自定义指标或画线

#### ✅ 任务 7.3：阅读示例代码
- [ ] 查看 `tests/` 目录下的示例
- [ ] 查看 `klinecharts-preview` 项目（如果可用）
- [ ] 查看 `klinecharts-pro` 项目（如果可用）

---

## 📖 推荐阅读顺序

### 核心文件（必读）
1. `src/index.ts` - 入口文件
2. `src/Chart.ts` - 核心类（最重要）
3. `src/Store.ts` - 状态管理
4. `src/Options.ts` - 配置选项

### 基础模块（重要）
5. `src/common/Data.ts` - 数据模型
6. `src/common/Coordinate.ts` - 坐标系统
7. `src/common/Canvas.ts` - Canvas 管理
8. `src/common/Styles.ts` - 样式定义

### 组件模块（重要）
9. `src/component/Indicator.ts` - 指标组件
10. `src/component/Overlay.ts` - 画线组件
11. `src/component/Axis.ts` - 坐标轴组件

### 视图模块（重要）
12. `src/view/View.ts` - 视图基类
13. `src/view/CandleBarView.ts` - K 线渲染
14. `src/view/IndicatorView.ts` - 指标渲染
15. `src/view/OverlayView.ts` - 画线渲染

### 面板模块（重要）
16. `src/pane/Pane.ts` - 面板基类
17. `src/pane/CandlePane.ts` - K 线面板
18. `src/pane/IndicatorPane.ts` - 指标面板

---

## 🔍 学习技巧

1. **从入口开始**：先看 `src/index.ts`，理解整体架构
2. **追踪调用链**：从 `init()` 开始，追踪整个初始化流程
3. **画图理解**：用纸笔画出数据流、渲染流程、事件流
4. **断点调试**：在关键位置打断点，观察执行流程
5. **修改测试**：尝试修改代码，观察效果变化
6. **阅读文档**：结合在线文档理解 API 设计
7. **查看示例**：运行示例代码，理解实际用法

---

## 📝 学习笔记模板

### 文件：`文件名.ts`
- **作用**：这个文件的主要功能
- **关键类/函数**：
  - `ClassName` - 作用说明
  - `functionName()` - 作用说明
- **依赖关系**：依赖哪些模块，被哪些模块依赖
- **核心逻辑**：关键实现思路
- **疑问**：不理解的地方

---

## 🎓 进阶学习

完成基础学习后，可以：
1. 阅读完整的 TypeScript 类型定义
2. 理解构建系统（Rollup 配置）
3. 研究性能优化技巧
4. 贡献代码或修复 bug
5. 开发自定义扩展

---

## 📅 学习计划建议

- **第 1 周**：阶段一 + 阶段二（项目基础和核心概念）
- **第 2 周**：阶段三（核心功能深入）
- **第 3 周**：阶段四 + 阶段五（交互事件和扩展机制）
- **第 4 周**：阶段六 + 阶段七（高级特性和实践）

---

## 💡 常见问题

1. **如何调试？**
   - 使用浏览器开发者工具
   - 在关键函数添加 console.log
   - 使用 VS Code 的调试功能

2. **如何理解复杂的类型定义？**
   - 先看使用场景，再看类型定义
   - 使用 IDE 的类型提示功能
   - 查看实际调用的地方

3. **如何理解渲染流程？**
   - 从数据变化开始追踪
   - 理解 View 的 draw 方法
   - 理解 Canvas 的绘制顺序

---

**祝学习顺利！如有问题，可以查看文档或提交 Issue。**


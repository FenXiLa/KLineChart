<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>KLineChart å­¦ä¹ ç¤ºä¾‹ - åŸºç¡€ä½¿ç”¨</title>
  <!-- ä½¿ç”¨ CDN å¼•å…¥ KLineChart -->
  <script type="text/javascript" src="https://unpkg.com/klinecharts/dist/klinecharts.min.js"></script>
  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: Arial, sans-serif;
    }
    #chart {
      width: 100%;
      height: 600px;
      border: 1px solid #ddd;
    }
    .info {
      margin: 20px 0;
      padding: 15px;
      background: #f5f5f5;
      border-radius: 5px;
    }
    .code {
      background: #f0f0f0;
      padding: 10px;
      border-radius: 3px;
      font-family: monospace;
      margin: 10px 0;
    }
  </style>
</head>
<body>
  <h1>KLineChart å­¦ä¹ ç¤ºä¾‹ - åŸºç¡€ä½¿ç”¨</h1>
  
  <div class="info">
    <h3>ğŸ“š å­¦ä¹ ç›®æ ‡</h3>
    <p>è¿™ä¸ªç¤ºä¾‹å¸®åŠ©ä½ ç†è§£ï¼š</p>
    <ul>
      <li>å¦‚ä½•åˆå§‹åŒ–å›¾è¡¨ï¼ˆå¯¹åº” <code>src/index.ts</code> çš„ <code>init()</code> å‡½æ•°ï¼‰</li>
      <li>å¦‚ä½•æ·»åŠ æ•°æ®ï¼ˆå¯¹åº” <code>chart.applyNewData()</code> æ–¹æ³•ï¼‰</li>
      <li>å¦‚ä½•æ·»åŠ æŒ‡æ ‡ï¼ˆå¯¹åº” <code>chart.createIndicator()</code> æ–¹æ³•ï¼‰</li>
    </ul>
  </div>

  <div id="chart"></div>

  <div class="info">
    <h3>ğŸ’¡ ä»£ç è¯´æ˜</h3>
    <div class="code">
// 1. åˆå§‹åŒ–å›¾è¡¨
// è¿™ä¸€æ­¥ä¼šè°ƒç”¨ src/index.ts ä¸­çš„ init() å‡½æ•°
// ç„¶ååˆ›å»º ChartImp å®ä¾‹ï¼ˆsrc/Chart.tsï¼‰
var chart = klinecharts.init('chart')

// 2. æ·»åŠ æ•°æ®
// æ•°æ®æ ¼å¼å¯¹åº” src/common/Data.ts ä¸­çš„ KLineData ç±»å‹
chart.applyNewData(generateSampleData())

// 3. æ·»åŠ æŒ‡æ ‡
// æŒ‡æ ‡ç³»ç»Ÿåœ¨ src/component/Indicator.ts ä¸­å®šä¹‰
// å…·ä½“æŒ‡æ ‡å®ç°åœ¨ src/extension/indicator/ ç›®å½•ä¸­
chart.createIndicator('MA')  // ç§»åŠ¨å¹³å‡çº¿
chart.createIndicator('VOL') // æˆäº¤é‡
    </div>
  </div>

  <div class="info">
    <h3>ğŸ” ä¸‹ä¸€æ­¥å­¦ä¹ </h3>
    <ol>
      <li>æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰ï¼Œåœ¨ Console ä¸­æŸ¥çœ‹ <code>chart</code> å¯¹è±¡</li>
      <li>å°è¯•è°ƒç”¨ <code>chart.getDataList()</code> æŸ¥çœ‹æ•°æ®</li>
      <li>å°è¯•è°ƒç”¨ <code>chart.getIndicators()</code> æŸ¥çœ‹æŒ‡æ ‡</li>
      <li>é˜…è¯» <code>src/index.ts</code> ä¸­çš„ <code>init()</code> å‡½æ•°</li>
      <li>é˜…è¯» <code>src/Chart.ts</code> ä¸­çš„ <code>ChartImp</code> ç±»</li>
    </ol>
  </div>

  <script>
    // ç”Ÿæˆç¤ºä¾‹æ•°æ®
    function generateSampleData() {
      const data = []
      let basePrice = 100
      const baseTime = Date.now() - 100 * 24 * 60 * 60 * 1000 // 100å¤©å‰
      
      for (let i = 0; i < 100; i++) {
        const change = (Math.random() - 0.5) * 10
        const open = basePrice
        const close = basePrice + change
        const high = Math.max(open, close) + Math.random() * 5
        const low = Math.min(open, close) - Math.random() * 5
        const volume = Math.floor(Math.random() * 1000000) + 500000
        
        data.push({
          timestamp: baseTime + i * 24 * 60 * 60 * 1000,
          open: open,
          high: high,
          low: low,
          close: close,
          volume: volume
        })
        
        basePrice = close
      }
      
      return data
    }

    // åˆå§‹åŒ–å›¾è¡¨
    window.onload = function () {
      console.log('ğŸš€ å¼€å§‹åˆå§‹åŒ–å›¾è¡¨...')
      
      // æ­¥éª¤ 1: åˆå§‹åŒ–å›¾è¡¨
      // è¿™ä¸€æ­¥ä¼šï¼š
      // 1. è°ƒç”¨ src/index.ts çš„ init() å‡½æ•°
      // 2. åˆ›å»º ChartImp å®ä¾‹ï¼ˆsrc/Chart.tsï¼‰
      // 3. åˆå§‹åŒ– Storeï¼ˆsrc/Store.tsï¼‰
      // 4. åˆ›å»ºå„ä¸ª Paneï¼ˆsrc/pane/ï¼‰
      var chart = klinecharts.init('chart')
      
      console.log('âœ… å›¾è¡¨åˆå§‹åŒ–å®Œæˆ', chart)
      console.log('ğŸ“Š å›¾è¡¨ ID:', chart.id)
      
      // æ­¥éª¤ 2: æ·»åŠ æ•°æ®
      const data = generateSampleData()
      chart.applyNewData(data)
      console.log('âœ… æ•°æ®æ·»åŠ å®Œæˆï¼Œå…±', data.length, 'æ¡')
      
      // æ­¥éª¤ 3: æ·»åŠ æŒ‡æ ‡
      chart.createIndicator('MA', false, { id: 'candle_pane' })
      console.log('âœ… æ·»åŠ  MA æŒ‡æ ‡')
      
      chart.createIndicator('VOL')
      console.log('âœ… æ·»åŠ  VOL æŒ‡æ ‡')
      
      console.log('ğŸ‰ å›¾è¡¨åˆ›å»ºå®Œæˆï¼')
      console.log('ğŸ’¡ æç¤ºï¼šåœ¨ Console ä¸­å°è¯•è°ƒç”¨ chart.getDataList() æŸ¥çœ‹æ•°æ®')
    }
  </script>
</body>
</html>


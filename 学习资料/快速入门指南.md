# KLineChart 快速入门指南

## 🚀 第一步：环境检查

你的环境已经准备好了：
- ✅ Node.js: v23.10.0
- ✅ pnpm: 已安装

## 📦 第二步：安装依赖

在项目根目录执行：

```bash
cd /Users/luosen/Documents/GitHub/KLineChart
pnpm install
```

这将安装所有项目依赖。

## 🏗️ 第三步：构建项目

构建项目以生成 dist 文件：

```bash
pnpm build
```

## 📚 第四步：启动文档服务器

启动本地文档服务器，方便查看和学习：

```bash
pnpm docs:dev
```

然后在浏览器中打开：http://localhost:8888

## 🎯 第五步：开始学习

### 推荐的学习顺序：

1. **先看入口文件** - `src/index.ts`
   - 这是整个库的入口点
   - 了解如何初始化和销毁图表
   - 了解注册机制

2. **再看核心类** - `src/Chart.ts`
   - 这是最重要的文件
   - 理解图表的完整生命周期
   - 理解主要的 API 方法

3. **理解数据模型** - `src/common/Data.ts`
   - K 线数据的结构
   - 数据如何存储

4. **理解状态管理** - `src/Store.ts`
   - 图表状态如何管理
   - 数据如何更新

5. **理解渲染系统** - `src/view/` 目录
   - 各个视图如何渲染
   - Canvas 如何绘制

## 💡 学习技巧

### 1. 使用 IDE 的跳转功能
- 在 VS Code 中，按住 Cmd/Ctrl 点击函数名可以跳转到定义
- 使用 Cmd/Ctrl + Shift + O 可以搜索文件中的符号

### 2. 使用浏览器调试
- 在关键函数中添加 `console.log`
- 使用浏览器开发者工具的断点功能
- 观察函数调用栈

### 3. 画流程图
- 用纸笔画出数据流
- 画出渲染流程
- 画出事件处理流程

### 4. 运行示例
- 查看 `tests/` 目录下的示例
- 修改示例代码，观察效果

## 📝 第一个任务：理解初始化流程

让我们从最简单的开始，理解图表是如何初始化的。

### 任务步骤：

1. **打开 `src/index.ts`**
   - 找到 `init()` 函数（第 91 行）
   - 理解它做了什么：
     - 检查 DOM 元素
     - 创建 ChartImp 实例
     - 将实例存储到 Map 中

2. **打开 `src/Chart.ts`**
   - 找到 `ChartImp` 类的构造函数（大约第 100 行开始）
   - 理解初始化过程：
     - 创建 Store
     - 创建各个 Pane
     - 绑定事件
     - 初始化 Canvas

3. **打开 `src/Store.ts`**
   - 理解 Store 的作用
   - 查看它存储了哪些数据

### 建议的阅读顺序：

```
src/index.ts (init 函数)
  ↓
src/Chart.ts (ChartImp 构造函数)
  ↓
src/Store.ts (Store 类)
  ↓
src/pane/Pane.ts (面板基类)
  ↓
src/pane/CandlePane.ts (K线面板)
```

## 🔍 代码阅读示例

### 示例 1：理解 init 函数

```typescript
// src/index.ts 第 91-114 行
function init (ds: HTMLElement | string, options?: Options): Nullable<Chart> {
  // 1. 获取 DOM 元素
  let dom: Nullable<HTMLElement> = null
  if (isString(ds)) {
    dom = document.getElementById(ds)
  } else {
    dom = ds
  }
  
  // 2. 检查 DOM 是否存在
  if (dom === null) {
    logError('...')
    return null
  }
  
  // 3. 检查是否已经初始化
  let chart = charts.get(dom.id)
  if (isValid(chart)) {
    logWarn('...')
    return chart
  }
  
  // 4. 创建新的图表实例
  const id = `k_line_chart_${chartBaseId++}`
  chart = new ChartImp(dom, options)
  chart.id = id
  dom.setAttribute('k-line-chart-id', id)
  charts.set(id, chart)
  return chart
}
```

**理解要点：**
- 支持传入 DOM 元素或 ID 字符串
- 防止重复初始化
- 为每个实例分配唯一 ID
- 将实例存储在全局 Map 中

### 示例 2：理解 ChartImp 构造函数

建议你打开 `src/Chart.ts`，找到构造函数，然后：
1. 看看它调用了哪些方法
2. 理解每个方法的作用
3. 追踪 Store 的创建过程

## 📖 下一步

完成第一个任务后，继续学习清单中的其他任务：
- 查看 `学习清单.md` 文件
- 按照阶段逐步学习
- 每完成一个任务，在清单中打勾 ✅

## 🆘 遇到问题？

1. **查看文档**：https://www.klinecharts.com
2. **查看示例**：`tests/` 目录
3. **查看 Issues**：GitHub Issues
4. **查看代码注释**：代码中有详细的中文注释

## 🎉 开始你的学习之旅吧！

记住：不要急于求成，一步一步来。理解每个模块的作用和设计思路，比快速看完所有代码更重要。

